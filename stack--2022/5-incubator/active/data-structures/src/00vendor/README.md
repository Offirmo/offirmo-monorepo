In order to have this lib "no deps", we copy/paste a few other libs.
